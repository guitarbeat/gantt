% moved from templates/document.tpl

\documentclass[9pt]{extarticle}

% Core packages (load early)
\usepackage{expl3}
\usepackage{xparse}
\usepackage{calc}
\usepackage{geometry}

% Font configuration - use modern sans-serif font
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\renewcommand{\familydefault}{\sfdefault}

% Color and graphics
\usepackage[table]{xcolor}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{adjustbox}

% Table and array packages
\usepackage{array}
\usepackage{tabularx}
\usepackage{multirow}
\usepackage{makecell}

% Layout and spacing
\usepackage{setspace}
\usepackage{leading}
\usepackage{dashrule}
\usepackage{varwidth}
\usepackage{wrapfig}
\usepackage{marginnote}
\usepackage{fancyhdr}

% Math and symbols
\usepackage{mathtools}
\usepackage{amssymb}

% Special features
\usepackage{multido}
\usepackage{pgffor}
\usepackage[most]{tcolorbox}
\usepackage{blindtext}
\usepackage{hyperref}


\hypersetup{hidelinks}

\geometry{paperwidth=15.6cm, paperheight=20.9cm}
\geometry{
  top=1.0cm,
  bottom=0.5cm,
  left=0.5cm,
  right=0.5cm,
  marginparwidth=1cm,
  marginparsep=0cm
}

\pagestyle{empty}
\reversemarginpar
\newcolumntype{Y}{>{\centering\arraybackslash}X}
\parindent=0pt
\fboxsep0pt

\begin{document}

% Simple macros template without problematic LaTeX commands
\ExplSyntaxOn
\cs_new_eq:NN \Repeat \prg_replicate:nn
\ExplSyntaxOff\newlength{\myLenTabColSep}
\newlength{\myLenLineThicknessDefault}
\newlength{\myLenLineThicknessThick}
\newlength{\myLenLineHeightButLine}
\newlength{\myLenTwoColSep}
\newlength{\myLenTwoCol}
\newlength{\myLenTriColSep}
\newlength{\myLenTriCol}
\newlength{\myLenFiveColSep}
\newlength{\myLenFiveCol}
\newlength{\myLenMonthlyCellHeight}

\newlength{\myLenHeaderResizeBox}
\newlength{\myLenHeaderSideMonthsWidth}

\setlength{\myLenTabColSep}{3.5pt}
\setlength{\myLenLineThicknessDefault}{.4pt}
\setlength{\myLenLineThicknessThick}{.8pt}
\setlength{\myLenLineHeightButLine}{\dimexpr5mm-.4pt}
\setlength{\myLenTwoColSep}{5pt}
\setlength{\myLenTwoCol}{5pt}
\setlength{\myLenTriColSep}{5pt}
\setlength{\myLenTriCol}{5pt}
\setlength{\myLenFiveColSep}{5pt}
\setlength{\myLenFiveCol}{5pt}
\setlength{\myLenMonthlyCellHeight}{70pt}

\setlength{\myLenHeaderResizeBox}{6mm}
\setlength{\myLenHeaderSideMonthsWidth}{14.5cm}

% Simple task bar definitions
\newlength{\TaskBarHeight}
\setlength{\TaskBarHeight}{4mm}
\newlength{\TaskBorderWidth}
\setlength{\TaskBorderWidth}{0.6pt}
\newlength{\TaskPaddingH}
\setlength{\TaskPaddingH}{1.5mm}
\newlength{\TaskPaddingV}
\setlength{\TaskPaddingV}{0.5mm}

% Array stretch macro
\newcommand{\myNumArrayStretch}{1.2}

% Line thickness macro
\newcommand{\myLineThick}{\rule{\linewidth}{\myLenLineThicknessThick}}

% Category palette setup macro
\newcommand{\SetupDefaultCategoryPalette}[1]{#1}

% Simple task rendering
\newcommand{\SimpleTaskBar}[4]{%
  \fbox{\parbox{\dimexpr#3-2\TaskPaddingH\relax}{%
    \vspace{\TaskPaddingV}%
    \centering\small\textbf{#1}%
    \vspace{\TaskPaddingV}%
  }}%
}

% Task overlay box macros
\newcommand{\TaskOverlayBox}[3]{%
  \fcolorbox{#1}{#1!20}{\parbox{\linewidth}{%
    \centering\small\textbf{#2}\\#3%
  }}%
}

\newcommand{\TaskOverlayBoxP}[3]{%
  \fcolorbox{#2}{#2!20}{\parbox{\linewidth}{%
    \centering\small\textbf{#1}\\#3%
  }}%
}

% Task compact box macro with better spacing and height
\newcommand{\TaskCompactBox}[4]{%
  \vspace*{#1}%
  \fcolorbox{#3}{#3!20}{\parbox{\dimexpr\linewidth-2\fboxsep\relax}{%
    \vbox to #2{%
      \vfil
      \centering\small\textbf{#4}%
      \vfil
    }%
  }}%
  \vspace*{0.1ex}%
}

% Underline macro
\newcommand{\myUnderline}[1]{%
  \underline{\textbf{#1}}%
}

% Color legend macro for task categories - matches actual task colors
\newcommand{\ColorLegend}{%
  \vspace*{-2ex}%
  \begin{center}%
    \small\textbf{Task Categories:}%
    \hspace{1em}%
    \fcolorbox{blue}{blue!20}{\parbox{2.2em}{\centering\tiny Proposal}}%
    \hspace{0.4em}%
    \fcolorbox{orange}{orange!20}{\parbox{2.2em}{\centering\tiny Laser}}%
    \hspace{0.4em}%
    \fcolorbox{green}{green!20}{\parbox{2.2em}{\centering\tiny Imaging}}%
    \hspace{0.4em}%
    \fcolorbox{purple}{purple!20}{\parbox{2.2em}{\centering\tiny Admin}}%
    \hspace{0.4em}%
    \fcolorbox{red}{red!20}{\parbox{2.2em}{\centering\tiny Dissertation}}%
    \hspace{0.4em}%
    \fcolorbox{teal}{teal!20}{\parbox{2.2em}{\centering\tiny Research}}%
    \hspace{0.4em}%
    \fcolorbox{gray}{gray!20}{\parbox{2.2em}{\centering\tiny Publication}}%
  \end{center}%
  \vspace*{0.1ex}%
}


  \include{monthly}
  
\end{document}
